SQL> 
SQL> CREATE DATABASE LINK "DB.DATA-PC02" CONNECT TO mama158 IDENTIFIED BY aBa33B using 'data-pc02';

Database link created.

SQL> 
SQL> CREATE TABLE EMPLOYEE AS (SELECT * FROM EMPLOYEE@"DB.DATA-PC02" WHERE STATE IN ('WA','Vic','Tas'));

Table created.

SQL> 
SQL> CREATE TABLE DRIVER AS (SELECT * FROM DRIVER@"DB.DATA-PC02" WHERE E# IN (SELECT E# FROM EMPLOYEE WHERE STATE IN ('WA','Vic','Tas')));

Table created.

SQL> 
SQL> CREATE TABLE ADMIN AS (SELECT * FROM ADMIN@"DB.DATA-PC02" WHERE E# IN (SELECT E# FROM EMPLOYEE WHERE STATE IN ('WA','Vic','Tas')));

Table created.

SQL> 
SQL> CREATE TABLE TRUCK AS (SELECT * FROM TRUCK@"DB.DATA-PC02");

Table created.

SQL> 
SQL> CREATE TABLE TRIP AS (SELECT * FROM TRIP@"DB.DATA-PC02" WHERE L# IN (SELECT L# FROM DRIVER));

Table created.

SQL> 
SQL> CREATE TABLE TRIPLEG AS (SELECT * FROM TRIPLEG@"DB.DATA-PC02" WHERE T# IN (SELECT T# FROM TRIP));

Table created.

SQL> 
SQL> CREATE TABLE SKILL AS (SELECT * FROM SKILL@"DB.DATA-PC02");

Table created.

SQL> 
SQL> CREATE TABLE SKILLREQUIRED AS (SELECT * FROM SKILLREQUIRED@"DB.DATA-PC02");

Table created.

SQL> 
SQL> CREATE TABLE SKILLPOSSESSED AS (SELECT * FROM SKILLPOSSESSED@"DB.DATA-PC02" WHERE E# IN (SELECT E# FROM EMPLOYEE WHERE STATE IN ('WA','Vic','Tas')));

Table created.

SQL> 
SQL> 
SQL> ALTER TABLE EMPLOYEE ADD CONSTRAINT EMPLOYEE_PKEY PRIMARY KEY(E#);

Table altered.

SQL> ALTER TABLE DRIVER ADD (CONSTRAINT DRIVER_PKEY PRIMARY KEY(E#),
  2  	     CONSTRAINT DRIVER_UNIQUE UNIQUE(L#),
  3  	     CONSTRAINT DRIVER_FKEY FOREIGN KEY(E#) REFERENCES EMPLOYEE(E#),
  4  	     CONSTRAINT DRIVER_STATUS CHECK ( STATUS IN ('AVAILABLE', 'BUSY', 'ON LEAVE')));

Table altered.

SQL> ALTER TABLE ADMIN ADD (CONSTRAINT ADMIN_PKEY PRIMARY KEY(E#),
  2  	     CONSTRAINT ADMIN_FKEY FOREIGN KEY(E#) REFERENCES EMPLOYEE(E#));

Table altered.

SQL> ALTER TABLE TRUCK ADD (CONSTRAINT TRUCK_PKEY PRIMARY KEY(REG#),
  2  	     CONSTRAINT TRUCK_STATUS CHECK ( STATUS IN ('AVAILABLE', 'USED', 'MAINTAINED')));

Table altered.

SQL> ALTER TABLE TRIP ADD (CONSTRAINT TRIP_PKEY PRIMARY KEY (T#),
  2  	     CONSTRAINT TRIP_FKEY1 FOREIGN KEY (L#) REFERENCES DRIVER(L#),
  3  	     CONSTRAINT TRIP_FKEY2 FOREIGN KEY (REG#) REFERENCES TRUCK(REG#));

Table altered.

SQL> ALTER TABLE TRIPLEG ADD (CONSTRAINT TRIPLEG_PKEY PRIMARY KEY (T#, LEG#),
  2  	     CONSTRAINT TRIPLEG_UNIQUE UNIQUE(T#, DEPARTURE, DESTINATION),
  3  	     CONSTRAINT TRIPLEG_FKEY1 FOREIGN KEY (T#) REFERENCES TRIP(T#));

Table altered.

SQL> ALTER TABLE SKILL ADD(CONSTRAINT SKILL_pkey PRIMARY KEY ( sname ));

Table altered.

SQL> ALTER TABLE SKILLREQUIRED ADD (CONSTRAINT SKILLREQUIRED_pkey PRIMARY KEY ( sname, requires ),
  2  	     CONSTRAINT SKILLREQUIRED_fkey1 FOREIGN KEY ( sname)
  3  		     REFERENCES SKILL( sname ),
  4  	     CONSTRAINT SKILLREQUIRED_fkey2 FOREIGN KEY ( requires )
  5  		     REFERENCES SKILL( sname ));

Table altered.

SQL> ALTER TABLE SKILLPOSSESSED ADD (CONSTRAINT SKILLPOSSESSED_PKEY PRIMARY KEY(E#, SNAME),
  2  	     CONSTRAINT SKILLPOSSESSED_FKEY1 FOREIGN KEY(SNAME) REFERENCES SKILL(SNAME),
  3  	     CONSTRAINT SKILLPOSSESSED_FKEY2 FOREIGN KEY(E#) REFERENCES ADMIN(E#));

Table altered.

SQL> 
SQL> 
SQL> DELETE FROM SKILLPOSSESSED@"DB.DATA-PC02" WHERE E# IN (SELECT E# FROM EMPLOYEE WHERE STATE IN ('WA','Vic','Tas'));

3 rows deleted.

SQL> DELETE FROM ADMIN@"DB.DATA-PC02" WHERE E# IN (SELECT E# FROM EMPLOYEE WHERE STATE IN ('WA','Vic','Tas'));

2 rows deleted.

SQL> DELETE FROM DRIVER@"DB.DATA-PC02" WHERE E# IN (SELECT E# FROM EMPLOYEE WHERE STATE IN ('WA','Vic','Tas'));

1 row deleted.

SQL> DELETE FROM EMPLOYEE@"DB.DATA-PC02" WHERE STATE IN ('WA','Vic','Tas');

3 rows deleted.

SQL> 
SQL> DROP DATABASE LINK "DB.DATA-PC02";

Database link dropped.

SQL> SPOOL OFF;
