SQL> SET ECHO ON
SQL> SET FEEDBACK ON
SQL> SET LINESIZE 100
SQL> SET PAGESIZE 100
SQL> SET SERVEROUTPUT ON
SQL> CREATE OR REPLACE PROCEDURE FINDAPPS(positionNumber IN SNEEDED.PNUMBER%TYPE)
IS
  minSkillLevel SNEEDED.SLEVEL%TYPE;
  currentSkillLevel SPOSSESSED.SLEVEL%TYPE;
  applicantNumber APPLICANT.ANUMBER%TYPE;
  CURSOR Q1 IS
    SELECT APPLICANT.ANUMBER, SPOSSESSED.SLEVEL FROM APPLICANT
    JOIN SPOSSESSED ON APPLICANT.ANUMBER = SPOSSESSED.ANUMBER;
BEGIN

  SELECT MIN(SLEVEL) INTO minSkillLevel FROM SNEEDED WHERE PNUMBER = positionNumber;

  DBMS_OUTPUT.PUT(minSkillLevel || ':');
  
  OPEN Q1;
  LOOP
    FETCH Q1 INTO applicantNumber, currentSkillLevel;
    IF Q1%NOTFOUND THEN EXIT; END IF;
    
    IF currentSkillLevel >= minSkillLevel THEN
      DBMS_OUTPUT.PUT(' ' || applicantNumber);
    END IF;
    
    END LOOP;
  CLOSE Q1;
  
  DBMS_OUTPUT.PUT_LINE('');

END FINDAPPS;
/

Procedure FINDAPPS compiled

SQL> EXECUTE FINDAPPS(7);

PL/SQL procedure successfully completed.

5: 1 1 2 2 3 3 3 5 6 7 7 8 10 10 10 11 11 12 13 13 14 17 17 18 18 18 19 20

SQL> SPOOL OFF;
